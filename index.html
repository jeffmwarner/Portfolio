<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Symptom Triage</title>

<style>
.assistant-output {
  white-space: pre-wrap;      /* keep newlines, allow wrapping */
  word-wrap: break-word;      /* break long words if needed */
  padding: 0.75rem;
  background: #f3f3f3;
  border-radius: 4px;
}
  
</style>
</head>
<h2>Try a Sample Mental Health Intake Prompt</h2>
<div>
  <textarea id="userInput" rows="4" placeholder="Tell me a bit about how you're feeling today..."></textarea>
  <br />
  <button id="sendRealBtn">Ask the assistant</button>
</div>
<pre id="realAssistantOutput" class="assistant-output"></pre>

<script>
  const API_URL = "https://conversation-backend-yxsq.onrender.com/api/chat"; // my backend URL at Render

  document.getElementById("sendRealBtn").addEventListener("click", async () => {
    const inputEl = document.getElementById("userInput");
    const outputEl = document.getElementById("realAssistantOutput");
    const text = inputEl.value.trim();

    if (!text) {
      outputEl.textContent = "Please type something so I can send it to the assistant.";
      return;
    }

    outputEl.textContent = "Thinking...";

    try {
      const res = await fetch(API_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: text })
      });

      if (!res.ok) {
        outputEl.textContent = "The assistant ran into a problem. Please try again later.";
        return;
      }

      const data = await res.json();

      const formatReply = (text) => {
        return text.replace(/{[.?!])\s+\g, '$1\n\n');
      }
      
      outputEl.textContent = data.reply;
    } catch (err) {
      console.error(err);
      
      outputEl.textContent = "Network error talking to the assistant.";
    }
  });
</script>

</html>
